<!doctype html><html lang=ja-jp><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>ブログをオレオレCMSからHugoに移行した - 横あるき</title><meta name=description content="変なことを書き綴るサイトです。"><link rel=icon type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=152x152 href=/favicons/152x152.png><link rel=icon type=image/png sizes=192x192 href=/favicons/192x192.png><meta name=msapplication-config content="https://kuno.kdns.info/browserconfig.xml"><link rel=stylesheet href=https://unpkg.com/normalize.css@8.0.1/normalize.css><link rel=stylesheet href="/style.css?d=20210203113050"><meta property="og:title" content="ブログをオレオレCMSからHugoに移行した"><meta property="og:description" content="移行の経緯 前回の記事から半年経っていますね。何でこんなに間が空いたかを説明できるような納得感のある理由があるかといえば、ないです。 しいて言え"><meta property="og:type" content="article"><meta property="og:url" content="https://kuno.kdns.info/2018/05/finnish-migration-hugo/"><meta property="og:image" content="https://kuno.kdns.info/favicons/310x310.png"><meta property="article:published_time" content="2018-05-15T09:54:53+09:00"><meta property="article:modified_time" content="2018-05-15T09:54:53+09:00"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://kuno.kdns.info/favicons/310x310.png"><meta name=twitter:title content="ブログをオレオレCMSからHugoに移行した"><meta name=twitter:description content="移行の経緯 前回の記事から半年経っていますね。何でこんなに間が空いたかを説明できるような納得感のある理由があるかといえば、ないです。 しいて言え"><meta name=twitter:site content="@knokmki612"></head><body class=site-body><header class=site-header><div class=inner><h1><a href=/>横あるき</a></h1><p>変なことを書き綴るサイトです。</p><p class=text-browser-message><a href=#main>本文に移動</a></p></div></header><div class=site-header-blank></div><nav class=site-global-menu><ul><li><a href=/about/>私について</a></li><li><a href=/product/>作ったもの</a></li></ul></nav><div class=site-search><form class=inner method=get action=https://duckduckgo.com><input class=search-input type=search name=q placeholder=DuckDuckGoで記事検索 aria-label=語句を入力して記事を検索>
<input type=hidden name=sites value=https://kuno.kdns.info/>
<button class=search-button type=submit>
<img src=/search.svg alt=検索></button></form></div><main id=swup class=site-main><hr id=main class=text-browser-message><article class=site-article><header class=article-header><h2>ブログをオレオレCMSからHugoに移行した</h2><aside class=article-aside><div class=aside-row><div class=aside-column><span>公開日</span>
<time datetime=2018-05-15T09:54:53+09:00>2018/05/15</time></div></div><div class=aside-row><div class=aside-column><span>タグ</span>
<span><a href=/tags/%E6%97%A5%E8%A8%98/>日記</a>, <a href=/tags/%E3%81%8A%E7%9F%A5%E3%82%89%E3%81%9B/>お知らせ</a></span></div></div><div class=social-button><a class="button -twitter" href="http://twitter.com/share?url=https%3a%2f%2fkuno.kdns.info%2f2018%2f05%2ffinnish-migration-hugo%2f&text=%e3%83%96%e3%83%ad%e3%82%b0%e3%82%92%e3%82%aa%e3%83%ac%e3%82%aa%e3%83%acCMS%e3%81%8b%e3%82%89Hugo%e3%81%ab%e7%a7%bb%e8%a1%8c%e3%81%97%e3%81%9f&nbsp;-&nbsp;%e6%a8%aa%e3%81%82%e3%82%8b%e3%81%8d" target=_blank rel="noopener noreferrer"><img src=/twitter.svg alt=Twitter>ツイート
</a><a class="button -facebook" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fkuno.kdns.info%2f2018%2f05%2ffinnish-migration-hugo%2f" target=_blank rel="noopener noreferrer"><img src=/facebook.svg alt=Facebook>シェア
</a><a class="button -hatenabookmark" href=http://b.hatena.ne.jp/entry/https://kuno.kdns.info/2018/05/finnish-migration-hugo/ target=_blank rel="noopener noreferrer"><img src=/hatenabookmark.svg alt=はてなブックマーク>ブックマーク</a></div></aside></header><h3 id=移行の経緯>移行の経緯</h3><p>前回の記事から半年経っていますね。何でこんなに間が空いたかを説明できるような納得感のある理由があるかといえば、ないです。</p><p>しいて言えば(やっぱりある)、3年前に作って使っていたシェルスクリプトなCMS、<a href=https://github.com/knokmki612/sitesh>site.sh</a>でブログを管理していましたが、</p><ol><li>データと処理がごちゃごちゃでつらい</li><li>記事執筆用のオレオレフォーマットを拡張したくても面倒くさい</li><li>シェルスクリプトで全部やろうとするのが良くないのでは？</li><li>他の言語だとかなり良さげなのが既にあるので作り直すのもな…</li></ol><p>という堂々巡りを2年くらい前からやっており、微妙なsite.shの使い勝手の悪さで、記事を書くモチベーションが下がっていました。それで、この度ようやく<a href=https://gohugo.io>Hugo</a>に移行する決心がついたというわけです。</p><h3 id=hugoを選んだ理由>Hugoを選んだ理由</h3><ul><li>site.shが完成しようかという時に初めて知った静的サイトジェネレータがHugoだった</li><li>生成が早そう</li></ul><p>という2点がメインです。Go言語が好きと言えるほど使ったことはないです。が、テンプレート処理が<a href=https://golang.org/pkg/text/template/>標準パッケージ</a>なところとか、ありものを組み合わせている感じがして好きです。<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p>Hugoでサイトを組んでみた印象としては、色々なやり方があって、ベストプラクティスっぽいものはなさそうだなあということです。それだけ作り方に幅があるのは良いことだと思いますが、どこから手を付けたら良いか迷いましたので、ポイントかなというのをいくつか紹介したいと思います。</p><h3 id=hugoでサイトを組んでいた時の気づき>Hugoでサイトを組んでいた時の気づき</h3><h4 id=archetypeshttpsgohugoiocontent-managementarchetypesとsection-templateshttpsgohugoiotemplatessection-templatesの関係性><a href=https://gohugo.io/content-management/archetypes/>Archetypes</a>と<a href=https://gohugo.io/templates/section-templates/>Section Templates</a>の関係性</h4><ul><li>contentディレクトリ下の構成でSectionが定まる</li><li><code>archetypes/&lt;section>.md</code>を作るとhugo newでSectionにあわせた雛形を作ってくれる</li><li>mdに<code>type: &lt;section></code>で明示的に指定することもできる。(省略しても良い)</li></ul><h4 id=baseblockhttpsgohugoiotemplatesbasepartialhttpsgohugoiotemplatespartialsinternalhttpsgohugoiotemplatesinternal-templatesとshortcodeshttpsgohugoiocontent-managementshortcodesの関係性><a href=https://gohugo.io/templates/base/>Base(Block)</a>/<a href=https://gohugo.io/templates/partials/>Partial</a>/<a href=https://gohugo.io/templates/internal/>Internal</a> Templatesと<a href=https://gohugo.io/content-management/shortcodes/>Shortcodes</a>の関係性</h4><ul><li>Base Templatesは<code>{{ block }}</code>にしたところを<code>{{ define }}</code>で書き換えられる</li><li>Partial Templatesは<code>layouts/partials/**.html</code>を<code>{{ partial }}</code>で使いまわせる</li><li>Internal Templatesはあらかじめ用意されたPartial Templatesみたいなもん</li><li>Internal Templatesをカスタムする場合は<a href=https://github.com/gohugoio/hugo/tree/master/tpl/tplimpl/embedded/templates>ここ</a>をみてPartial Templatesにすればいい</li><li>個人的には<code>{{ block }}</code>と<code>{{ define }}</code>と<code>{{ partial }}</code>はPugの<a href=https://pugjs.org/language/inheritance.html>extendsとblock</a>と<a href=https://pugjs.org/language/includes.html>includes</a>に似ていると思った</li><li>Shortcodesは記事の中で凝ったマークアップ構造を使いたい時に使う<ul><li>画像とか動画とか</li><li><a href=https://gohugo.io/content-management/shortcodes/#use-hugo-s-built-in-shortcodes>あらかじめ用意された</a>Shortcodesもある</li></ul></li><li><a href=https://gohugo.io/templates/lookup-order/>Lookup Order</a>を見ながらテンプレートを配置すると良い</li></ul><h4 id=configの細かいところ>configの細かいところ</h4><ul><li><a href=https://gohugo.io/content-management/taxonomies/#preserve-taxonomy-values>preserveTaxonomyNames</a>を<code>true</code>にしとかないと、タグの文字列が<a href=https://gohugo.io/functions/urlize/>urlize</a>される</li><li><a href=https://gohugo.io/getting-started/configuration/#all-configuration-settings>hasCJKLanguage</a>を<code>true</code>にしとかないと、<code>.Summary</code>がスペース区切りの単語数でカウントされて、RSSフィードの<code>description</code>とかめちゃ長くなる<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></li><li><a href=https://gohugo.io/getting-started/configuration/#blackfriday>BlackfridayのplainIDAnchors</a>を<code>false</code>にしとかないと、同じ文字列の見出しが2つあるとidが重複する</li></ul><h4 id=最近のhugo032は便利>最近のHugo(0.32〜)は便利</h4><ul><li>画像や動画を<code>static</code>に置かないといけなかったのが、<code>&lt;記事のディレクトリ>/index.md</code>で一緒に置けるようになった<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup><ul><li>これは活用してる</li></ul></li><li><a href=https://gohugo.io/news/0.32-relnotes/>画像の最適化</a>もしてくれるようになった<ul><li>これは活用してない</li></ul></li></ul><h3 id=hugoに移行した結果>Hugoに移行した結果</h3><p>Markdownで記事が書けるようになったのは、前と比較したら良くなったかなと思います。勘違いしてほしくないのは、私はそんなにMarkdownが好きではないということです(面倒くさい人だ)。それでも、リストのネストが簡単に書けるようになったのは良かったですね。</p><p>それと同じくらい、Shortcodeが使えるようになったのも良かったです。site.shで記法を拡張したかったのは、任意のHTMLコードを使いまわせるようなところだったので。</p><p>今回移行するに当たってHugoのテーマも作成したので、参考になればさいわいです。</p><p><a href=https://github.com/knokmki612/hugo-pencil-and-ruler>https://github.com/knokmki612/hugo-pencil-and-ruler</a></p><p>これで記事を書くペースが上がるといいなぁ…</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>シェルスクリプトで頑張っていたからそう感じるのかねぇ…いや、シェルスクリプト的にはコマンドを活用すれば良くて、自分がそういう風にうまく書けなかっただけだな… <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://blog.awm.jp/2016/01/02/hugo/>Hugo のサマリーが大きすぎる件 - awm-Tech</a> <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=https://blog.ton-up.net/2018/01/13/hugo-032/>Hugo 0.32から記事と同じ場所に画像を置けるようになった - blog.ton-up.net</a> <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article></main><nav class=site-side-menu><div class=inner><section class="menu-section -width-100pct"><h2>フィード</h2><a class=feed-button href=/blog/index.xml><img src=/rss.svg alt=フィード></a></section><section class="menu-section -width-50pct"><h2><a href=/tags/>タグ</a></h2><ul><li><a href=https://kuno.kdns.info/tags/%E6%97%A5%E8%A8%98/>日記</a> (30)</li><li><a href=https://kuno.kdns.info/tags/oss-gate/>OSS Gate</a> (14)</li><li><a href=https://kuno.kdns.info/tags/%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC/>レビュー</a> (12)</li><li><a href=https://kuno.kdns.info/tags/%E3%82%AC%E3%82%B8%E3%82%A7%E3%83%83%E3%83%88/>ガジェット</a> (9)</li><li><a href=https://kuno.kdns.info/tags/sailfish-os/>Sailfish OS</a> (8)</li><li><a href=https://kuno.kdns.info/tags/jolla/>Jolla</a> (6)</li><li><a href=https://kuno.kdns.info/tags/tips/>Tips</a> (6)</li><li><a href=https://kuno.kdns.info/tags/%E3%81%8A%E7%9F%A5%E3%82%89%E3%81%9B/>お知らせ</a> (5)</li><li><a href=https://kuno.kdns.info/tags/%E6%98%A0%E7%94%BB/>映画</a> (3)</li><li><a href=https://kuno.kdns.info/tags/%E9%9B%91%E8%A8%98/>雑記</a> (3)</li><li><a href=https://kuno.kdns.info/tags/%E6%94%BE%E9%80%81%E5%A4%A7%E5%AD%A6/>放送大学</a> (2)</li><li><a href=https://kuno.kdns.info/tags/windows/>Windows</a> (1)</li><li><a href=https://kuno.kdns.info/tags/%E3%82%A8%E3%83%A2%E3%81%84/>エモい</a> (1)</li><li><a href=https://kuno.kdns.info/tags/%E6%9C%AC/>本</a> (1)</li></ul></section><section class="menu-section -width-50pct"><h2><a href=/archives/>アーカイブ</a></h2><ul><li><a href=https://kuno.kdns.info/archives/2020/>2020</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2020/>2020</a> (1)</li><li><a href=https://kuno.kdns.info/archives/2019/>2019</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2019/>2019</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2019/>2019</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2018/>2018</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2018/>2018</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2018/>2018</a> (8)</li><li><a href=https://kuno.kdns.info/archives/2018/>2018</a> (2)</li><li><a href=https://kuno.kdns.info/archives/2018/>2018</a> (2)</li></ul></section></div></nav><footer class=site-footer><div class=inner><p>&copy; 2015 knokmki612</p></div></footer><div class=site-footer-blank></div><script src=https://unpkg.com/swup/dist/swup.min.js></script><script src=https://unpkg.com/@swup/scroll-plugin/dist/SwupScrollPlugin.min.js></script><script src=https://unpkg.com/@swup/preload-plugin/dist/SwupPreloadPlugin.min.js></script><script src=/index.js></script></body></html>